![](https://p.ipic.vip/cfnkto.png)

Python中的数据类型可以分为可变对象和不可变对象。了解它们之间的区别对于编写高效的Python代码至关重要。

本文将详细介绍可变对象和不可变对象的概念，以及如何正确地使用它们来提高代码的性能和可读性。

## 1. 引言

### 可变对象与不可变对象的定义

在Python中，对象可以分为两种主要类型：可变对象和不可变对象。

- **可变对象**：其值可以在创建后被修改，包括列表、字典和集合等。
- **不可变对象**：其值在创建后不能被修改，包括整数、浮点数、字符串和元组等。

这个区分基于对象的内容是否可以更改来定义，它对于理解Python中的数据类型非常重要。

## 2. 不可变对象

### 数值、字符串和元组

#### 数值

数值对象是不可变的，一旦创建，它们的值不能被修改。这包括整数（int）、浮点数（float）和复数（complex）等。例如：

```python
x = 5  # 创建一个整数对象
x = x + 1  # 创建一个新的整数对象，x的值变为6
```

#### 字符串

字符串是不可变的，一旦创建，字符串的内容不能被更改。

例如：

```python
s = "Hello"
s[0] = "h"  # 这会引发TypeError，字符串内容不可修改
```

#### 元组

元组也是不可变的数据类型，一旦创建，元组的元素不能被修改。

例如：

```python
t = (1, 2, 3)
t[0] = 4  # 这会引发TypeError，元组的元素不可修改
```

## 3. 可变对象

### 列表、字典和集合

#### 列表

列表是Python中的可变对象，可以随时添加、删除或修改列表中的元素。

例如：

```python
my_list = [1, 2, 3]
my_list.append(4)  # 向列表添加一个元素
my_list[1] = 5  # 修改列表中的元素
del my_list[0]  # 从列表中删除元素
```

#### 字典

字典是另一个可变对象，它包含键值对。可以添加、删除或修改字典中的键值对。

例如：

```python
my_dict = {"name": "Alice", "age": 30}
my_dict["age"] = 31  # 修改键值对的值
my_dict["city"] = "New York"  # 添加新的键值对
del my_dict["name"]  # 删除键值对
```

#### 集合

集合是一种可变的无序数据类型，可以添加或删除集合中的元素。

例如：

```python
my_set = {1, 2, 3}
my_set.add(4)  # 向集合添加元素
my_set.remove(2)  # 从集合中删除元素
```

## 4. 可变与不可变的影响

### 参数传递

在Python中，参数传递的方式与对象的可变性有关。

- **不可变对象的参数传递**：当你将不可变对象作为参数传递给函数时，函数内部的操作不会影响到原始对象的值。这是因为不可变对象在传递时相当于创建了一个副本。

- **可变对象的参数传递**：当你将可变对象作为参数传递给函数时，函数内部的操作会影响原始对象的值，因为它们引用的是相同的对象。

考虑以下示例：

```python
def modify_string(s):
    s = s + " World"  # 创建一个新的字符串对象
    print(s)

my_string = "Hello"
modify_string(my_string)
print(my_string)  # 输出仍为"Hello"
```

上述示例中，尽管在函数内部修改了字符串`s`，但原始字符串`my_string`的值并未受到影响，因为字符串是不可变对象。

### 缓存

Python中对不可变对象的缓存是一种性能优化机制。由于不可变对象的值不会更改，Python可以在内存中缓存相同的对象，以减少内存占用和提高性能。

这意味着如果创建多个相同值的不可变对象，它们实际上可能会引用相同的对象。这可以在比较不可变对象时提高速度，但需要小心，因为对象的不可变性可能会导致不期望的结果。

## 5. 示例代码

下面是一些示例代码，演示如何操作可变和不可变对象：

### 操作不可变对象

```python
# 操作不可变对象（字符串）
original_string = "Hello"
modified_string = original_string + " World"  # 创建新的字符串对象


print(original_string)  # 输出："Hello"
print(modified_string)  # 输出："Hello World"
```

### 操作可变对象

```python
# 操作可变对象（列表）
my_list = [1, 2, 3]
my_list.append(4)  # 修改原始列表
print(my_list)  # 输出：[1, 2, 3, 4]

# 参数传递中的可变对象
def modify_list(lst):
    lst.append(5)

modify_list(my_list)
print(my_list)  # 输出：[1, 2, 3, 4, 5]
```

## 6. 最佳实践

### 选择合适的对象类型

选择合适的对象类型对于代码的性能和可读性至关重要。不可变对象在某些情况下更加高效，因为它们不需要考虑对象的更改。但在需要频繁修改数据的情况下，可变对象可能更为合适。

### 避免不必要的拷贝

在处理可变对象时，要小心不要创建不必要的拷贝。在某些情况下，共享相同对象可以提高性能。使用`copy`模块进行深拷贝或浅拷贝时要小心，以免不必要地占用内存。

## 总结

这就是Python中的可变对象和不可变对象的概念，以及它们之间的区别。理解这些概念对于编写高效和可读的Python代码非常重要。不可变对象在创建后不可修改，包括数值、字符串和元组，而可变对象可以随时修改，包括列表、字典和集合。

还有可变和不可变对象在参数传递和内存缓存方面的影响。选择合适的对象类型和避免不必要的拷贝是写出高质量Python代码的关键。

通过深入了解和正确使用可变和不可变对象，可以更好地理解Python的数据模型，提高代码的性能和可维护性。

--- 

## Python学习路线

<img width="1357" alt="Python基础知识" src="https://github.com/sitinme/Python_study/assets/5089397/5df21811-fd10-43c1-9066-1b192262b268">

## 更多学习｜面试资料

个人网站：http://ipengtao.com/

![](https://p.ipic.vip/knbt3a.png)
